# Depends on: qtbase qtwebchannel qtlocation xorg-libxcomposite xorg-libxrandr pciutils libvpx libevent snappy nss protobuf libxslt ffmpeg git gperf icu zlib libwebp xorg-libxscrnsaver
description="Provides support for web applications using the Chromium browser project"
url="http://qt-project.org/"
packager="tnut <tnut@nutyx.org>"
contributors="Pierre B"

name=qtwebengine
version=5.11.2
release=1
_name="${name}-everywhere-src"

source=(https://download.qt.io/official_releases/qt/5.11/$version/submodules/${_name}-${version}.tar.xz
		qtwebengine-harmony.patch)

build() {
  mkdir build
  mkdir -p bin
  ln -s /usr/bin/python2 bin/python
  patch -Np1 -i ../qtwebengine-harmony.patch
  cd build 
  qmake  ../${_name}-${version} -- \
    -proprietary-codecs \
    -system-ffmpeg \
    -webp \
    -spellchecker \
    -webengine-icu
  make
  make INSTALL_ROOT=$PKG install
  find "$PKG/usr/lib" -type f -name '*.prl' \
    -exec sed -i -e '/^QMAKE_PRL_BUILD_DIR/d' {} \;
}
